# CrcHack
一个制造crc32碰撞的工具类

```csharp
public static class CRC32Hack {
    /// <summary>
    /// 根据configs重写source，使得重写后的数据crc32值等于targetCrc32。
    /// </summary>
    /// <param name="source">要重写的数据</param>
    /// <param name="targetCrc32">目标crc32</param>
    /// <param name="configs">重写配置。两两之间不允许重叠</param>
    /// <returns>返回重写后的数据。如果无解则返回null。</returns>
    public static byte[]? Hack(ReadOnlySpan<byte> source, uint targetCrc32, params OverwriteConfig[] configs);

    /// <summary>
    /// 求一个非零的x，使得crc32(x) = 0。
    /// 可以让 crc32(data ^ x) = crc32(data)
    /// </summary>
    /// <param name="sourceLength">源数据长度</param>
    /// <param name="configs">重写配置。两两之间不允许重叠</param>
    /// <returns>如果无解，则返回null</returns>
    public static byte[]? Zero(int sourceLength, params OverwriteConfig[] configs);
}
```
```csharp
/// <summary>
/// 配置需要重写的位置、长度、数据和位掩码。
/// </summary>
public readonly struct OverwriteConfig {
    /// <param name="offset">
    /// 字节偏移量（必须）
    /// </param>
    /// <param name="length">
    /// 字节长度（必须）
    /// </param>
    /// <param name="data">
    /// 覆盖数据（可选）
    /// 如果为null，则表示该区域可以随意填充数据，否则将使用指定的数据来覆盖源数据
    /// </param>
    /// <param name="mask">
    /// 位掩码（可选）
    /// 位掩码为1的位置表示可以被修改，位掩码为0的位置不受影响。如果为null，则默认位掩码全为1。
    /// </param>
    public OverwriteConfig(int offset, int length, byte[]? data = null, byte[]? mask = null);
}
```

### 使用示例1

```csharp
using CrcHack;

var input = new byte[] { 0x12, 0x23, 0x34, 0x45, 0, 0, 0, 0, 0x99, 0x88, 0x77 };
Console.WriteLine($" input: {Convert.ToHexString(input)}");
Console.WriteLine($" crc32: {CRC32(input):x8}");

var config = new OverwriteConfig(offset: 4, length: 4); // input[4..8]可以随意赋值
byte[]? output = CRC32Hack.Hack(input, targetCrc32: 0, config); // 目标crc32值设为0
if (output != null) {
    Console.WriteLine($"output: {Convert.ToHexString(output)}");
    Console.WriteLine($" crc32: {CRC32(output):x8}");
} else {
    Console.WriteLine("无解");
}
```
输出
```
 input: 1223344500000000998877
 crc32: e42e5cc1
output: 12233445BB1233E1998877
 crc32: 00000000
```

---
### 使用示例2

```csharp
ReadOnlySpan<byte> input = """
    function sum(a, b) {
        return a + b;
    }
    """u8;
Span<byte> template = """
    function sum(a, b) {
        return a - b; // aaaaaaaaa
    }
    """u8.ToArray();

var config = new OverwriteConfig(offset: 43, length: 9, mask: new byte[] { 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf });
uint targetCrc32 = CRC32(input);
byte[]? output = CRC32Hack.Hack(template, targetCrc32, config);
if (output != null) {
    Console.WriteLine(Encoding.UTF8.GetString(input));
    Console.WriteLine($"crc32: {CRC32(input):x8}");
    Console.WriteLine();
    Console.WriteLine(Encoding.UTF8.GetString(output));
    Console.WriteLine($"crc32: {CRC32(output):x8}");
}
```
输出
```
function sum(a, b) {
    return a + b;
}
crc32: 76881cb8

function sum(a, b) {
    return a - b; // cllejdeac
}
crc32: 76881cb8
```
---



### md5+crc32碰撞示例

```
msg1 sha1 = 2CF4578DD2003A91E566939DEF58C9EBC714E50A
msg2 sha1 = 07695CE92959091BE309B2AE0527B1EC122544B8
msg1 md5 = B06440AED8DB0BEAF8333718553DB3A2
msg2 md5 = B06440AED8DB0BEAF8333718553DB3A2
msg1 crc32 = 00000000
msg2 crc32 = 00000000
```

#### msg1:
```
380DDBB15608165F279EB2643EE293A9177CC98F22BA6336293A3912F244101B
AD03BE04EEA3B94847663BB9CDDD4C68E04B85D5B4F5FC4688B25729B272677C
8B83C6DFD9F8AFE264B0D52D70FAA2FDE3770DA6126C762C28F9AE354A6C05FE
AD1FF62C8B93B927D687C50991607D1DF334C0B15AB79393DA9518DF9FC545C6
9ADA82B6CC22BC7A6AF1E3E4D33C2898C07C4995D51D0F6B400E821A994A45AB
46FBCAFD70A3196FEB01CFF9FF8718FED14BE167377B2CA80A72742DFB119017
46C951011391E73530CD2DF2F6FC2EBDD9711C378798C23C00C928F6D008E19D
C9573325F4F81768066CF5C181FCD99C0041C89875C50371F221106765A7A960
6CB6D99B67E066E4E91D5C480096529DB07EEECAAEBD40DA09DE3F5D8A24A5CD
DBE9B9FE6C6939AB4BCAC534FD63E47BCF918046885295F12F9FDAD46390C53D
6E0A91B134B012D2F218202F74EC7DFBCE33B9A7C005412E00756228CCD455CF
3507B6369E13F7A8F24C01B295005E9FD9A0BB377AD523390B3241E00C8B40C7
6FADC8B3843BBD93F6FE59BDF0C5C490D4ADBACE49F7000827AE7B66ACA340A1
93E3F3CCFE47DE75CB61E7BACBB5ED4444567FF10EEA6DC4754B2CC8D5C4A83C
811AD7C4695576152FC2E0E19D70017BC1D38870606022DAABC330389B5FA8B8
D7F5443497820FFC343CCA7A111CF7CAA9069C18F0B61F59E965D0B081245469
EA62746C11A4FCA62F319DB4DEB1510464F1944119E40DC8246E44E2509237AE
55C9A0CDE04478796BC643D1EF074E1840F2478AFC7CC5FA2748BD7709345D43
C8BBA696BEC1A47945180D71498A3BFEBCFC3732176616E2CB1AFE3BEC07DEE3
00853E94F40F04046A925C3797E809A942A74BBCD0947B782AE51816C727B1F5
643F37CE5382779BC4828A9EF2D1F9D63A4DF8DE33D973BC27EA8099E9218AAD
0ADB00E85CEE7C1EC7CF6504B431B8861803B58B86CBCD784EBFEC4D4CAA10EB
31CCCE823EBC462C3DC76CFE78A4569BD51E9E4206FD8E2B84FFEB575F5163C1
F6D8C42A926B92F6EBB9EBD810E36C4180AC6FFFFE20F12DD45FC0C36442754A
7BF2D14853018DB98EA404EA3C61BDC41E05A405C1A824DA0D024211D0181DDE
E923AB085E08B5C04B2446F9D0BDBB484C6AE94FA0608C6719266DA450EE9E61
6473CB511032A3C49B4F576D232763CEC907D65B74DCF2F18DC3F0778B5F68C7
D36B6444A7864C1C3AFD493B63CC1753636CABA481C1F6FDABCB39C2210F5EBD
9DC9E5B98BAFCD427A4A660281F66E7BBB92A5718002DB1E082E8241124C4567
9BB909C558A8F3DDCBC15B5A8D335DC03013AE8611907C605EF07285ACB0FC93
605F925AB55D8E1C390AF4CB2B636A484E0621CC1A7A2115DD5B16C154197DAE
754BDED658A37E35A76FB1CFCC9180A691ED97598A223755724FC6761DC0C7DD
57C176804847987D49EA19682C3569F321C317FD47843F3A416A410AAA838CC2
710CFBC27A344EEE6B686BC408F478777D5DB867474D85FC79B8EA998ACAA53D
94603CFEB455AE4AD2AF6DA3219112D32A3DCC37CFC22A3D262D7496CF5C4D8F
A5B7F9BCB29448A74A71C97990586DBEC4000EC66EBED3BE8FD9DFE821737FD6
08B1D88D92540E25C8215636D420302DC63FA2B359C8FE704D0A7F26EC3AA208
F723B0EBFE0D2EC2EF69D33CC0CDE5F9C2659A0DD49EA639DEB20E34DAC2AD30
0F47CE01C12E923A1B06F0F42F7FC524AA052E74EE39A121C53BF3C0D561791E
B99A16DE1EE296505FB1D1EF82AE4FEA078A801F7E37608599941E21C88BDD8E
118CAC59789AF0D79AC0447D232530ABCBF6A67779A38E9B37C67F79CCCF32E3
B71BF6DEEC093635EBBDF63B169C13AE8AEE232414FE9C1C5A87D467172B2737
7E7E9A58F84BA0D3D45D3547A4134CC5C912C22741DFF42CFE64EA76CC84CDAD
6DF8F1A7BAB21E49CE61013A8EA05A1DE8207D7171C5838CD9D4206D5994AACE
C7865A470E33355B9D5C1A589198F1F9E89C63204FB078E354FE40756E2294B6
09DAFEF150AD53084B063C122B7C592AD3576119723C2E89266937085E434941
41D15CB4CC64809073F9F909AB7F7D403ABCD6CBFB05365FCB5A76BDEC47E269
2046A61AF64FE0FFBA87416FEDC0666CE4463F0220572B6C86662FB35BC15202
6B4DEBD3AC2FB3C949A337C054F42BFD0F7A99459E1E4B011F467C753386A909
1AC302E66ACD11A9CB273F5A0034B5636BCBA05BCFC9F536D4A4343903A1AE0B
79A569530027656E6D3B966E40CDF96FD7B49DCD12D8139F74EBBF5B4F4D4B41
662EB98E747083F7E9C1EFB8D9466A47812A253F04AB8CAD6730F24EE56BF15C
B67B3B540D7CA07C16168B1231C70FD369AF01C6C54CBCFD31E23ADD4818AA30
2DFEF9DA5A2E460F6720D36315D244D10B8A47E8D3D96C982809CB8646A5A8FB
F30F0113008DB6F79EE152EC6D5A100599999C18464CFB1DF80C7347CC7BCDEF
8557BE85EAD3FC65DA1711728998F95CDBA43825D5BF230B501BD068EFC5EFB2
46D1BA32D1F40DB86DC72CE9D0C9418983E9D4DDC0AC4CEF2A124261AB200D10
DA13BE0AEE0C16834B28C70311AA389747C9792A5718C5A3227CE35FA941FA8F
13F1C7D9EC81EF6929CC7534B136FE0B280D823FFF251E6AD31AEE3DEC87DE65
1E4D261AF6CFE30C989350F7B874F76CDD9DE92F60996A308948BD0656832715
EAB0630FEB52F9E19CE51FE37E1A92D2695CF26BE82F0CC1392A393EC48AA0CE
DFD1C70B4EAC03F36762E87C15AE100EB34872832B54966EAE663E95A88CD154
6A56052B97894CCF6A7C94C8992A6624A89EBA86F5A51E22C91A0638ECC7DD63
3E8BC6180450DF8C686E70AF78EC05EF30752252FE4DD02948192D53A3E99C0E
0CC3D7B89F7FEE81FAAC737F43C00C54F393E7DDE5A851922812808D0F3FB3D6
BED3BA0FDEE4A8C4EF5D5E3B20A2132925F9CC3BA6BAE52BE27AF60C138F591B
1E4633647A1B214F1923F0653F6ED51FB88FBDFA0F662666CB5A86CDECC601EE
B61CA656024E038E9A1F504FC09C652E18C2291E43B51BEBFF956EE73BEFE060
7BC451B8A11349201D400BF375906DF48D1CAED959BC873D294A385AD0AA21C2
2DCDBB05629221A94B2ACB3ADC55055CF509C883E347EC495627C7212A447594
2445FA76F9EE7CB95A3FD223572B089A4235F92649DD0EEDF4B86565CE39BEED
45283E69961489885E34097287DC485CE8F8BD3DBEC6F30DAB9B80DCF3863346
A7AA74BE2EAB75DFD5C2D8DB9374001F2A656A2414C121372FFE3F5AE639159B
FFB5E9C7CC2EFC676B46E134240AD22A19ACBFD7120C769D1D624C88E986B9B1
7FFAF13D00310C7ACCF08CB6F2A46F625BF563978E0DC5DC2C15A0864E15AA8E
D5CF7EC61ED5E6E8F21BF9518EC49A9DEA7838F74DDB63D94ADEFAF7A7B038F1
1773716069C17978FF268458DD512E174FD4D743AFA6579A409E39A2CFBBB2E0
74BCF3E24A6E04476B1ED53BEE272B74015266B247AAD5BD8BE47A54167D7B0C
E1AF3304543A52795639295D4906A3F684FF23320BA63626D35A6E47EC86DEEB
6883BE5402940383DA6F682F785876AE6BD521746D96D263A45B7245C13F9074
2DE69EA3883772DA9880852CE7922D173598BB626D3E30DD45163CBD491833DC
36EACBE24C0440058B3EECDCC8E1B82E2323EBCF1B7775439800A84F022BFDAD
6821ED5B9649D1800D3F28655DAB352F38AECF711FA626A6CB1AEEB9EC86DEE9
20C346D6044E28FDDA8F752F783466EA623DE2AB3AB4429681A38750AE02E97A
AD75AAA3CF2BE17DB7EEF307E3A52BEE8DB84052A6963A2161463C3AD37DBBBF
300AFBCDDCE277338BBC733A12162D2D3377210DA3223E937803198A9FA81D0E
EE6CDF870C398C70DF5612FA234966A5302648621535405DC97713C9596979B2
4B6FDFBE69C7AE756191D0AF8CFE7268FD6420D67F69D0D959D5256DE157D4B7
4E2E1037E6595077647749EC3DC131FE8C2D55913DB769BE0D8E7CD68CAC11FB
11FDD4F8BF8A3F9F072E513AE37F6AA091C98D0C9ADFD4701A2F4161BB54A374
C4594237AFBFDB6DEF30B3388D11E7DD0835C7B7C19BE6FDF46CDF14D17ACDAE
3DD0FE68E12F3E07E6565982A3C8A93F1C9D8719D4C0936E8F9A677913281A86
D3901A911A26ABB7139136CC2BA3720B65789B8B18D737222E6A39BE2C9C30DC
E1B504DFB88627D167BEC82325180397E386DDF74E35154C944129E3385C36CE
2AB6789F8DB758433DFBD133F5D932ECE252D1951B80EC1D06F96316D11652D0
ADEF3E4988D3C3C58640194288B0DC9BE17C5D8DCFC2F358E89B115A9BCBF3A7
7F6159E9C8AB8F611DCCDF24F0A55AB907E1FB50D49E8A3D4F4E403ACA9CA54A
BBECBC0AC867E8384B0A41FCCD5F9FA2D0BA73C4A96FEC12F76AE4E528FD3914
69DE9047743B2FC33C712CABCF8AF59BC9559D17BC213FDC0C5D65B64ECD7D1E
C9873B145A573867F644055A9A00A69FD3CC78D182CB53896C6A41F05207AE71
6CD870E3B22835A6925B1797AA778817DBC3651D57E9A0CE4BFE8269D21BACB2
EBC5E3DCD826CE18E74747B2C3FF44178A5CED4700E81CBE574F746D7F8CF52A
504B61333FA5A3A02F9A0801CD86025A047CD650F9454625D15AEE48EC86E271
9866C657F4CCFB7D8A536DD7B184F52C4E8ED18177226CB63BD9F10920C4DDD2
FAAAC53727B60E603B6CB3A34A7A595986ED93A705CB343F334682E90978B345
920819E3CE8A2B51EBDDCB5B1BE4CDADAC0A6BAAFBFCDC44858EFCE07AB124FE
669A7CE0DC0B612AC9D0604BDE3D59DD83F2E944405A820CF6787636CB9BCCFD
D5FFB13DE5334BA8323D05328D1882BED16CB1FF6EBBA323831401DDE341F2F7
C00AA28438F76BA0150F2D26E9EC6F5BCA37203CA41EC4EC4FBE416545FA948B
B0EDC1C74A4C3B366BE6F8140A4C116EB95F41E48A7B73D22DE9735DD57337A9
7BC775DFDCB4C0C37F70280F26D3CB962A307B982EAF4ADBEA749746D277FDDC
85103AA857347AA7FE39FDC1988456FDAA5035CB6ED3E340572B7AEBCA92C35E
619A36628BCFFE0B6C2DAF1AB4DC89C2820DB44181BFB39A4C5640F2AEA0A51F
67EBBE06BE5F67586BE23B3CF30F3D8EC12537F4282B7D992A70ACC7187304BF
C77E7D85B33E275B80E2460C2DAE5DCD43BC88A6BF27F32D10B968564DFC0DEF
6507331D342FF6A5EA75116286FC20BDCE74244F8FCE4303ED9C88ED839CC00A
F6E60E0B36CF06037D119F0EA84B335C0D1A7A11DC47310D13BA3E6DDA22C4BC
CB11BA09EC66FD366B025AF9EFBF70152C9CC785C6649F7D90CC3972DE2EF2BE
7CCBB4C3BE2F2B01A95C4F693BA3352C78FF044EF5A516A5D11AF6B8EC46026A
C85C3ED6020D08427A236D57B918E9A837CDE204826CDE17E8271E38A021FAAC
5A53EFF3D90E7BCD662EC18623CA6820624768C6B631AB272A0E7A4A882C8738
D5DBA6026A541A1BE72F4B348BCD603D71BA532682442D15286C395A4DAE4A9D
8FA16CD355F82E8725F4E4D4DFAFA8523E08F9EE217C0016C59B17CDD5285D2E
81631EDB5BAA8ED7CB6FBDCF43596886A687E81DA4D3459CC1E1BB87B95891AB
44EB9ABEB05D07FFA22963AF13DB3E066C49188CEE37BB7D15AA3FEEB7C1ACA3
86E3E6D18024FE3F6FC0D639FA6D0C6BBDCB2F91E710CE96E37F6F634E1E925B
0BB31B478715FF250516175355ECBF8A8C99A7B8C668C3FD14D997B7D1683EB0
193F77EC59B229C82A6DB9698488CEBE1BB518B17DC153755854A26E5A4BA850
DA9A2673FD1DB2FC19548388B42173757352A11D2CDBBB2C4E2A771EEC43BECA
71C3F3BAE26D4C30EB61D5C3D5013386B223177A4EC2CC61054067BFD51C37E6
9DD2B721993DBE9A55112E0F812879365E66E2360176C159D557F3C850717DAE
0331DEE2294C6FB45F93ADAF53597D8C85957C2EC22FF02A9FD0AD6C197852E3
```

#### msg2:
```
380DDBB15608165F279EB2643EE293A9177CC90F22BA6336293A3912F244101B
AD03BE04EEA3B94847663BB9CD5D4C68E04B85D5B4F5FC4688B257A9B272677C
8B83C6DFD9F8AFE264B0D52D70FAA2FDE3770D26126C762C28F9AE354A6C05FE
AD1FF62C8B93B927D687C50991E07D1DF334C0B15AB79393DA95185F9FC545C6
9ADA82B6CC22BC7A6AF1E3E4D33C2898C07C4915D51D0F6B400E821A994A45AB
46FBCAFD70A3196FEB01CFF9FF0719FED14BE167377B2CA80A7274ADFB119017
46C951011391E73530CD2DF2F6FC2EBDD9711CB78798C23C00C928F6D008E19D
C9573325F4F81768066CF5C1817CD99C0041C89875C50371F22110E765A7A960
6CB6D99B67E066E4E91D5C480096529DB07EEE4AAEBD40DA09DE3F5D8A24A5CD
DBE9B9FE6C6939AB4BCAC534FDE3E37BCF918046885295F12F9FDA546390C53D
6E0A91B134B012D2F218202F74EC7DFBCE33B927C005412E00756228CCD455CF
3507B6369E13F7A8F24C01B295805E9FD9A0BB377AD523390B3241600C8B40C7
6FADC8B3843BBD93F6FE59BDF0C5C490D4ADBA4E49F7000827AE7B66ACA340A1
93E3F3CCFE47DE75CB61E7BACB35EE4444567FF10EEA6DC4754B2C48D5C4A83C
811AD7C4695576152FC2E0E19D70017BC1D388F0606022DAABC330389B5FA8B8
D7F5443497820FFC343CCA7A119CF6CAA9069C18F0B61F59E965D03081245469
EA62746C11A4FCA62F319DB4DEB1510464F194C119E40DC8246E44E2509237AE
55C9A0CDE04478796BC643D1EF874E1840F2478AFC7CC5FA2748BDF709345D43
C8BBA696BEC1A47945180D71498A3BFEBCFC37B2176616E2CB1AFE3BEC07DEE3
00853E94F40F04046A925C37976809A942A74BBCD0947B782AE51896C727B1F5
643F37CE5382779BC4828A9EF2D1F9D63A4DF85E33D973BC27EA8099E9218AAD
0ADB00E85CEE7C1EC7CF6504B4B1B8861803B58B86CBCD784EBFECCD4CAA10EB
31CCCE823EBC462C3DC76CFE78A4569BD51E9EC206FD8E2B84FFEB575F5163C1
F6D8C42A926B92F6EBB9EBD810636C4180AC6FFFFE20F12DD45FC0436442754A
7BF2D14853018DB98EA404EA3C61BDC41E05A485C1A824DA0D024211D0181DDE
E923AB085E08B5C04B2446F9D03DBC484C6AE94FA0608C6719266D2450EE9E61
6473CB511032A3C49B4F576D232763CEC907D6DB74DCF2F18DC3F0778B5F68C7
D36B6444A7864C1C3AFD493B634C1753636CABA481C1F6FDABCB3942210F5EBD
9DC9E5B98BAFCD427A4A660281F66E7BBB92A5718002DB1E082E8241124C4567
9BB909C558A8F3DDCBC15B5A8D335DC03013AE8611907C605EF07285ACB0FC93
605F925AB55D8E1C390AF4CB2B636A484E0621CC1A7A2115DD5B16C154197DAE
754BDED658A37E35A76FB1CFCC9180A691ED97598A223755724FC6761DC0C7DD
57C176804847987D49EA19682C3569F321C3177D47843F3A416A410AAA838CC2
710CFBC27A344EEE6B686BC4087479777D5DB867474D85FC79B8EA198ACAA53D
94603CFEB455AE4AD2AF6DA3219112D32A3DCCB7CFC22A3D262D7496CF5C4D8F
A5B7F9BCB29448A74A71C97990D86CBEC4000EC66EBED3BE8FD9DF6821737FD6
08B1D88D92540E25C8215636D420302DC63FA2B359C8FE704D0A7F26EC3AA208
F723B0EBFE0D2EC2EF69D33CC0CDE5F9C2659A0DD49EA639DEB20E34DAC2AD30
0F47CE01C12E923A1B06F0F42F7FC524AA052E74EE39A121C53BF3C0D561791E
B99A16DE1EE296505FB1D1EF82AE4FEA078A801F7E37608599941E21C88BDD8E
118CAC59789AF0D79AC0447D232530ABCBF6A67779A38E9B37C67F79CCCF32E3
B71BF6DEEC093635EBBDF63B169C13AE8AEE232414FE9C1C5A87D467172B2737
7E7E9A58F84BA0D3D45D3547A4134CC5C912C22741DFF42CFE64EA76CC84CDAD
6DF8F1A7BAB21E49CE61013A8EA05A1DE8207D7171C5838CD9D4206D5994AACE
C7865A470E33355B9D5C1A589198F1F9E89C63204FB078E354FE40756E2294B6
09DAFEF150AD53084B063C122B7C592AD3576119723C2E89266937085E434941
41D15CB4CC64809073F9F909AB7F7D403ABCD6CBFB05365FCB5A76BDEC47E269
2046A61AF64FE0FFBA87416FEDC0666CE4463F0220572B6C86662FB35BC15202
6B4DEBD3AC2FB3C949A337C054F42BFD0F7A99C59E1E4B011F467C753386A909
1AC302E66ACD11A9CB273F5A00B4B4636BCBA05BCFC9F536D4A434B903A1AE0B
79A569530027656E6D3B966E40CDF96FD7B49D4D12D8139F74EBBF5B4F4D4B41
662EB98E747083F7E9C1EFB8D9C66A47812A253F04AB8CAD6730F2CEE56BF15C
B67B3B540D7CA07C16168B1231C70FD369AF0146C54CBCFD31E23ADD4818AA30
2DFEF9DA5A2E460F6720D363155245D10B8A47E8D3D96C982809CB0646A5A8FB
F30F0113008DB6F79EE152EC6D5A100599999C98464CFB1DF80C7347CC7BCDEF
8557BE85EAD3FC65DA1711728918F95CDBA43825D5BF230B501BD0E8EFC5EFB2
46D1BA32D1F40DB86DC72CE9D0C9418983E9D45DC0AC4CEF2A124261AB200D10
DA13BE0AEE0C16834B28C703112A399747C9792A5718C5A3227CE3DFA941FA8F
13F1C7D9EC81EF6929CC7534B136FE0B280D82BFFF251E6AD31AEE3DEC87DE65
1E4D261AF6CFE30C989350F7B8F4F66CDD9DE92F60996A308948BD8656832715
EAB0630FEB52F9E19CE51FE37E1A92D2695CF26BE82F0CC1392A393EC48AA0CE
DFD1C70B4EAC03F36762E87C15AE100EB34872832B54966EAE663E95A88CD154
6A56052B97894CCF6A7C94C8992A6624A89EBA86F5A51E22C91A0638ECC7DD63
3E8BC6180450DF8C686E70AF78EC05EF30752252FE4DD02948192D53A3E99C0E
0CC3D7B89F7FEE81FAAC737F43C00C54F393E7DDE5A851922812808D0F3FB3D6
BED3BA0FDEE4A8C4EF5D5E3B20A2132925F9CC3BA6BAE52BE27AF60C138F591B
1E4633647A1B214F1923F0653F6ED51FB88FBDFA0F662666CB5A86CDECC601EE
B61CA656024E038E9A1F504FC09C652E18C2291E43B51BEBFF956EE73BEFE060
7BC451B8A11349201D400BF375906DF48D1CAE5959BC873D294A385AD0AA21C2
2DCDBB05629221A94B2ACB3ADCD5045CF509C883E347EC495627C7A12A447594
2445FA76F9EE7CB95A3FD223572B089A4235F9A649DD0EEDF4B86565CE39BEED
45283E69961489885E340972875C495CE8F8BD3DBEC6F30DAB9B805CF3863346
A7AA74BE2EAB75DFD5C2D8DB9374001F2A656A2414C121372FFE3F5AE639159B
FFB5E9C7CC2EFC676B46E134240AD22A19ACBFD7120C769D1D624C88E986B9B1
7FFAF13D00310C7ACCF08CB6F2A46F625BF563978E0DC5DC2C15A0864E15AA8E
D5CF7EC61ED5E6E8F21BF9518EC49A9DEA7838F74DDB63D94ADEFAF7A7B038F1
1773716069C17978FF268458DD512E174FD4D7C3AFA6579A409E39A2CFBBB2E0
74BCF3E24A6E04476B1ED53BEEA72B74015266B247AAD5BD8BE47AD4167D7B0C
E1AF3304543A52795639295D4906A3F684FF23B20BA63626D35A6E47EC86DEEB
6883BE5402940383DA6F682F78D875AE6BD521746D96D263A45B72C5C13F9074
2DE69EA3883772DA9880852CE7922D173598BB626D3E30DD45163CBD491833DC
36EACBE24C0440058B3EECDCC8E1B82E2323EBCF1B7775439800A84F022BFDAD
6821ED5B9649D1800D3F28655DAB352F38AECF711FA626A6CB1AEEB9EC86DEE9
20C346D6044E28FDDA8F752F783466EA623DE2AB3AB4429681A38750AE02E97A
AD75AAA3CF2BE17DB7EEF307E3A52BEE8DB840D2A6963A2161463C3AD37DBBBF
300AFBCDDCE277338BBC733A12962D2D3377210DA3223E937803190A9FA81D0E
EE6CDF870C398C70DF5612FA234966A5302648E21535405DC97713C9596979B2
4B6FDFBE69C7AE756191D0AF8C7E7268FD6420D67F69D0D959D525EDE157D4B7
4E2E1037E6595077647749EC3DC131FE8C2D55113DB769BE0D8E7CD68CAC11FB
11FDD4F8BF8A3F9F072E513AE3FF6AA091C98D0C9ADFD4701A2F41E1BB54A374
C4594237AFBFDB6DEF30B3388D11E7DD0835C737C19BE6FDF46CDF14D17ACDAE
3DD0FE68E12F3E07E6565982A348A93F1C9D8719D4C0936E8F9A67F913281A86
D3901A911A26ABB7139136CC2BA3720B65789B8B18D737222E6A39BE2C9C30DC
E1B504DFB88627D167BEC82325180397E386DDF74E35154C944129E3385C36CE
2AB6789F8DB758433DFBD133F5D932ECE252D1951B80EC1D06F96316D11652D0
ADEF3E4988D3C3C58640194288B0DC9BE17C5D8DCFC2F358E89B115A9BCBF3A7
7F6159E9C8AB8F611DCCDF24F0A55AB907E1FB50D49E8A3D4F4E403ACA9CA54A
BBECBC0AC867E8384B0A41FCCD5F9FA2D0BA73C4A96FEC12F76AE4E528FD3914
69DE9047743B2FC33C712CABCF8AF59BC9559D17BC213FDC0C5D65B64ECD7D1E
C9873B145A573867F644055A9A00A69FD3CC78D182CB53896C6A41F05207AE71
6CD870E3B22835A6925B1797AA778817DBC3659D57E9A0CE4BFE8269D21BACB2
EBC5E3DCD826CE18E74747B2C37F45178A5CED4700E81CBE574F74ED7F8CF52A
504B61333FA5A3A02F9A0801CD86025A047CD6D0F9454625D15AEE48EC86E271
9866C657F4CCFB7D8A536DD7B104F52C4E8ED18177226CB63BD9F18920C4DDD2
FAAAC53727B60E603B6CB3A34A7A595986ED93A705CB343F334682E90978B345
920819E3CE8A2B51EBDDCB5B1BE4CDADAC0A6BAAFBFCDC44858EFCE07AB124FE
669A7CE0DC0B612AC9D0604BDE3D59DD83F2E944405A820CF6787636CB9BCCFD
D5FFB13DE5334BA8323D05328D1882BED16CB1FF6EBBA323831401DDE341F2F7
C00AA28438F76BA0150F2D26E9EC6F5BCA3720BCA41EC4EC4FBE416545FA948B
B0EDC1C74A4C3B366BE6F8140ACC116EB95F41E48A7B73D22DE973DDD57337A9
7BC775DFDCB4C0C37F70280F26D3CB962A307B182EAF4ADBEA749746D277FDDC
85103AA857347AA7FE39FDC1980456FDAA5035CB6ED3E340572B7A6BCA92C35E
619A36628BCFFE0B6C2DAF1AB4DC89C2820DB4C181BFB39A4C5640F2AEA0A51F
67EBBE06BE5F67586BE23B3CF38F3C8EC12537F4282B7D992A70AC47187304BF
C77E7D85B33E275B80E2460C2DAE5DCD43BC8826BF27F32D10B968564DFC0DEF
6507331D342FF6A5EA751162867C21BDCE74244F8FCE4303ED9C886D839CC00A
F6E60E0B36CF06037D119F0EA84B335C0D1A7A91DC47310D13BA3E6DDA22C4BC
CB11BA09EC66FD366B025AF9EF3F71152C9CC785C6649F7D90CC39F2DE2EF2BE
7CCBB4C3BE2F2B01A95C4F693BA3352C78FF04CEF5A516A5D11AF6B8EC46026A
C85C3ED6020D08427A236D57B998E8A837CDE204826CDE17E8271EB8A021FAAC
5A53EFF3D90E7BCD662EC18623CA6820624768C6B631AB272A0E7A4A882C8738
D5DBA6026A541A1BE72F4B348BCD603D71BA532682442D15286C395A4DAE4A9D
8FA16CD355F82E8725F4E4D4DFAFA8523E08F9EE217C0016C59B17CDD5285D2E
81631EDB5BAA8ED7CB6FBDCF43596886A687E81DA4D3459CC1E1BB87B95891AB
44EB9ABEB05D07FFA22963AF13DB3E066C49180CEE37BB7D15AA3FEEB7C1ACA3
86E3E6D18024FE3F6FC0D639FAED0C6BBDCB2F91E710CE96E37F6FE34E1E925B
0BB31B478715FF250516175355ECBF8A8C99A738C668C3FD14D997B7D1683EB0
193F77EC59B229C82A6DB9698408CEBE1BB518B17DC153755854A2EE5A4BA850
DA9A2673FD1DB2FC19548388B42173757352A19D2CDBBB2C4E2A771EEC43BECA
71C3F3BAE26D4C30EB61D5C3D5813386B223177A4EC2CC610540673FD51C37E6
9DD2B721993DBE9A55112E0F812879365E66E2B60176C159D557F3C850717DAE
0331DEE2294C6FB45F93ADAF53D97C8C85957C2EC22FF02A9FD0ADEC197852E3
```

### md5+crc32碰撞源码(CrcHack.Example)
```csharp
using System.IO.Hashing;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using CrcHack;
using CrcHack.Example;

MD5_CRC32_Collision(targetCrc32: 0, showMsg: true);
Console.WriteLine("==============================================");
MD5_CRC32_Collision(targetCrc32: 0x23333333);
Console.WriteLine("==============================================");
MD5_CRC32_Collision(targetCrc32: 0x00114514);

static void MD5_CRC32_Collision(uint targetCrc32, bool showMsg = false) {
    // 构造33个config，每个config的data是 MD5Collision.Msg1[i] XOR MD5Collision.Msg2[i]
    // MD5Collision中的数据是事先碰撞好的，可以保证 md5(MD5Collision.Msg1[0] + ... + MD5Collision.Msg1[k]) = md5(MD5Collision.Msg2[0] + ... + MD5Collision.Msg2[k])  (0<=k<33, +是拼接的意思)
    // 而且这33组MD5碰撞数据，每组在MD5Collision.Msg1和MD5Collision.Msg2之间随意选取也不会改变MD5值。
    OverwriteConfig[] configs = new OverwriteConfig[33];
    for (int i = 0; i < configs.Length; i++) {
        var data = new byte[128];
        byte[] m1 = MD5Collision.Msg1[i];
        byte[] m2 = MD5Collision.Msg2[i];
        for (int j = 0; j < 128; j++) {
            data[j] = (byte)(m1[j] ^ m2[j]);
        }

        configs[i] = new OverwriteConfig(i * 128, 128, data);
    }

    // ============================================================

    // 求 crc32(xorMsg) = 0，且xorMsg不全为0，xorMsg是33 * 128字节的数据
    // xorMsg每128字节中，要么等于 MD5Collision.Msg1[i] XOR MD5Collision.Msg2[i]，要么等于全0
    // 于是有：
    //    MD5Collision.Msg1[i] XOR xorMsg[i*128 .. (i+1)*128] = MD5Collision.Msg1[i]
    // 或 MD5Collision.Msg1[i] XOR xorMsg[i*128 .. (i+1)*128] = MD5Collision.Msg2[i]
    // 
    //    MD5Collision.Msg2[i] XOR xorMsg[i*128 .. (i+1)*128] = MD5Collision.Msg1[i]
    // 或 MD5Collision.Msg2[i] XOR xorMsg[i*128 .. (i+1)*128] = MD5Collision.Msg2[i]
    var xorMsg = CRC32Hack.Zero(33 * 128, configs)!;

    // ============================================================

    // 把MD5Collision.Msg2放入configs中，然后MD5Collision.Msg1当成源数据，
    // 这样CRC32Hack.Hack就会在MD5Collision.Msg1和MD5Collision.Msg2之间选取消息，使得最终输出等于目标crc32值，同时不改变MD5值
    for (int i = 0; i < configs.Length; i++) {
        configs[i] = new OverwriteConfig(i * 128, 128, MD5Collision.Msg2[i]);
    }

    var msg1 = new byte[33 * 128];
    for (int i = 0; i < 33; i++) {
        MD5Collision.Msg1[i].CopyTo(msg1.AsSpan(i * 128, 128));
    }

    var outMsg1 = CRC32Hack.Hack(msg1, targetCrc32, configs)!;
    var outMsg2 = new byte[33 * 128];
    for (int i = 0; i < outMsg2.Length; i++) {
        outMsg2[i] = (byte)(outMsg1[i] ^ xorMsg[i]);
    }
    // 令 outMsg2 = outMsg1 XOR xorMsg
    // 因为 crc32(outMsg1 XOR xorMsg) = crc32(outMsg1) XOR crc32(xorMsg)
    // 又因为 crc32(xorMsg) = 0 且 xorMsg != 0
    // 所以 crc32(outMsg2) = crc32(outMsg1) 且 outMsg2 != outMsg1

    if (showMsg) {
        const int Length = 32;

        Console.WriteLine("xorMsg:");
        for (int i = 0; i < 33 * 128 / Length; i++) {
            Console.WriteLine(Convert.ToHexString(xorMsg.AsSpan(i * Length, Length)));
        }
        Console.WriteLine();

        Console.WriteLine("msg1:");
        for (int i = 0; i < 33 * 128 / Length; i++) {
            Console.WriteLine(Convert.ToHexString(outMsg1.AsSpan(i * Length, Length)));
        }
        Console.WriteLine();

        Console.WriteLine("msg2:");
        for (int i = 0; i < 33 * 128 / Length; i++) {
            Console.WriteLine(Convert.ToHexString(outMsg2.AsSpan(i * Length, Length)));
        }
        Console.WriteLine();
    }

    Console.WriteLine($"msg1 sha1 = {NETSHA1(outMsg1)}");
    Console.WriteLine($"msg2 sha1 = {NETSHA1(outMsg2)}");
    Console.WriteLine($"msg1 md5 = {NETMD5(outMsg1)}");
    Console.WriteLine($"msg2 md5 = {NETMD5(outMsg2)}");
    Console.WriteLine($"msg1 crc32 = {NETCrc32(outMsg1):x8}");
    Console.WriteLine($"msg2 crc32 = {NETCrc32(outMsg2):x8}");
}


static uint NETCrc32(ReadOnlySpan<byte> input) {
    uint output = 0;
    Crc32.Hash(input, MemoryMarshal.AsBytes(new Span<uint>(ref output)));
    return output;
}

static string NETMD5(ReadOnlySpan<byte> input) {
    Span<byte> output = stackalloc byte[16];
    MD5.HashData(input, output);
    return Convert.ToHexString(output);
}

static string NETSHA1(ReadOnlySpan<byte> input) {
    Span<byte> output = stackalloc byte[20];
    SHA1.HashData(input, output);
    return Convert.ToHexString(output);
}
```